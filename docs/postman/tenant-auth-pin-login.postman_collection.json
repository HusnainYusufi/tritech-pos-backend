{
  "info": {
    "_postman_id": "cb9ab5c4-36c1-4f9d-a09d-7ca6ff9f4f43",
    "name": "POS - PIN Login & Till Sessions",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json",
    "description": "Authenticate a cashier with Employee ID + PIN, then manage till opening/closing. SECURITY: Employee ID prevents cross-tenant PIN collisions."
  },
  "item": [
    {
      "name": "POST /t/auth/login-pin",
      "request": {
        "method": "POST",
        "header": [
          { "key": "Content-Type", "value": "application/json" },
          { "key": "x-tenant-id", "value": "{{tenant}}" }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"employeeId\": \"EMP-A7K3M2\",\n  \"pin\": \"123456\"\n}"
        },
        "url": {
          "raw": "{{base_url}}/t/auth/login-pin",
          "host": [ "{{base_url}}" ],
          "path": [ "t", "auth", "login-pin" ]
        },
        "description": "Login a staff member with Employee ID + PIN.\n\nSECURITY: Both fields are required:\n- employeeId: Format EMP-XXXXXX (given to employee by admin after PIN setup)\n- pin: 6-digit PIN\n\nReturns JWT without opening till. Use token for POS calls."
      },
      "response": []
    },
    {
      "name": "POST /t/pos/till/open",
      "request": {
        "method": "POST",
        "header": [
          { "key": "Content-Type", "value": "application/json" },
          { "key": "x-tenant-id", "value": "{{tenant}}" },
          { "key": "Authorization", "value": "Bearer {{token}}" }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"branchId\": \"64f0c2d9e0bd2f0012a9c001\",\n  \"posId\": \"POS-01\",\n  \"openingAmount\": 150.25,\n  \"cashCounts\": {\n    \"100\": 1,\n    \"50\": 1,\n    \"20\": 2\n  },\n  \"notes\": \"Opening till for morning shift\"\n}"
        },
        "url": {
          "raw": "{{base_url}}/t/pos/till/open",
          "host": [ "{{base_url}}" ],
          "path": [ "t", "pos", "till", "open" ]
        },
        "description": "Open a till session after PIN login. Requires Authorization with the staff token. Returns a new JWT with `tillSessionId` for downstream POS calls."
      },
      "response": []
    },
    {
      "name": "POST /t/pos/till/close",
      "request": {
        "method": "POST",
        "header": [
          { "key": "Content-Type", "value": "application/json" },
          { "key": "x-tenant-id", "value": "{{tenant}}" },
          { "key": "Authorization", "value": "Bearer {{token}}" }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"declaredClosingAmount\": 152.0,\n  \"systemClosingAmount\": 150.25,\n  \"cashCounts\": {\n    \"100\": 1,\n    \"50\": 1,\n    \"20\": 1\n  },\n  \"notes\": \"Closing after evening shift\",\n  \"posId\": \"POS-01\",\n  \"tillSessionId\": \"6500c2d9e0bd2f0012a9c123\"\n}"
        },
        "url": {
          "raw": "{{base_url}}/t/pos/till/close",
          "host": [ "{{base_url}}" ],
          "path": [ "t", "pos", "till", "close" ]
        },
        "description": "Close the active till session for the staff member/branch/POS. If `tillSessionId` is omitted the API resolves the open session by the authenticated user and location metadata."
      },
      "response": []
    }
  ],
  "variable": [
    { "key": "base_url", "value": "http://localhost:3000" },
    { "key": "tenant", "value": "demo-tenant" },
    { "key": "token", "value": "" },
    { "key": "employeeId", "value": "EMP-XXXXXX", "description": "Employee ID from staff creation/PIN setup" }
  ]
}
